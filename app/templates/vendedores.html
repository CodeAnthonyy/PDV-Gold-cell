{% extends "base.html" %}

{% block extra_css %}
    <link rel="stylesheet" href="{{ url_for('static', filename='cadastro_de_vendedores.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='vendedores.css') }}">
{% endblock %}

{% block content %}

<h2>Vendedores</h2>

<div class="products-header">

    <!-- Busca -->
    <form method="get" action="/vendas" class="search-box">

        <input 
            type="text" 
            name="search" 
            placeholder="Pesquisar vendedor..."
            value="{{ request.args.get('search','') }}"
        >

        <button type="submit">Buscar</button>

    </form>

    <!-- Novo button removed; form is embedded on this page -->

</div>

<!-- Tabela -->

<!-- Formulário embutido (acima da tabela) -->
<div id="new-seller" class="form-box left-form">

    <h3>{% if seller %}Editar Dados do Vendedor{% else %}Novo Vendedor{% endif %}</h3>

    <form method="post" action="/vendedores/novo">

        {% if seller %}
            <input type="hidden" name="seller_id" value="{{ seller[0] }}">
        {% endif %}

        <input 
            type="text" 
            name="seller_name"
            placeholder="Nome do vendedor"
            value="{% if seller %}{{ seller[1] }}{% endif %}"
            required
        >

        <input 
            type="tel"
            name="phone"
            placeholder="Telefone (opcional)"
            value="{% if seller %}{{ seller[2] or '' }}{% endif %}"
        >

        <button type="submit" name="action" value="{% if seller %}editar{% else %}novo{% endif %}">
            {% if seller %}Atualizar Vendedor{% else %}Cadastrar Vendedor{% endif %}
        </button>

    </form>

</div>

<table class="products-table">

    <tr>
        <th>ID</th>
        <th>Nome</th>
        <th>Telefone</th>
        <th>Ações</th>
    </tr>

    {% for seller in data %}
    <tr>
        <td>{{ seller[0] }}</td>
        <td>{{ seller[1] }}</td>
        <td>{{ seller[2] or "-" }}</td>

        <!-- Ações -->
        <td class="actions">

            <!-- Editar -->
            <a href="/vendedores?id={{ seller[0] }}">
                <button class="btn-edit">Editar</button>
            </a>

            <!-- Remover -->
            <a href="/vendedores/remover/{{ seller[0] }}"
               onclick="return confirm('Deseja realmente remover este vendedor?')">
                <button class="btn-delete">Remover</button>
            </a>

        </td>
    </tr>

    {% endfor %}

</table>

    </main>

</div>

{% endblock %}
